-- OPERAÇÕES CONTEMPLADAS PELO CASO DE TESTE:
-- ÁRVORE-B DE ORDEM 7
-- COM ARQUIVOS
-- TRANSFERÊNCIA
-- BUSCA DE TRANSAÇÃO
-- LISTAGEM DE TRANSAÇÕES POR PERÍODO
-- LISTAGEM DE TRANSAÇÕES POR CPF DE ORIGEM E PERÍODO
-- IMPRIMIR ARQUIVO CLIENTES
-- IMPRIMIR ARQUIVO TRANSAÇÕES
-- IMPRIMIR ARQUIVO DE ÍNDICE DE CLIENTES
-- IMPRIMIR ARQUIVO DE ÍNDICE DE TRANSAÇÕES
-- IMPRIMIR ARQUIVO DE ÍNDICE DE CHAVES PIX
-- IMPRIMIR ARQUIVO DE ÍNDICE DE TIMESTAMP

\echo file ARQUIVO_CLIENTES
66545678765;Maria Eugenia;12/04/1980;mariaeugenia@gmail.com;15998765645;0000000775.40;A97301660-afcb-4ea4-a5a6-7c3abe8b8fbb&C66545678765&N15998765645&Emariaeugenia@gmail.com;##################################################################################99876556782;Gabriel Augusto;04/05/1997;ga.augusto@gmail.com;15997675654;0000000670.00;C99876556782&N15997675654;################################################################################################################################################44565434213;Geovana Santana;25/10/1994;ge.santana@gmail.com;16996543652;0000001786.40;Ege.santana@gmail.com&C44565434213;#######################################################################################################################################54654367865;Gustavo Almeida;19/11/1992;galmeida@gmail.com;14998786754;0000000000.00;N14998786754&Egalmeida@gmail.com;###########################################################################################################################################37567876542;Melissa Santos;13/04/1977;melissa@gmail.com;15998765435;1000000440.92;;#############################################################################################################################################################################14565436782;Melissa Pereira;19/09/1993;melissa@gmail.com;15997654738;0000000764.00;Emelissa@gmail.com&A8c29d4ca-06a1-4ef4-b45c-0470946831c5&C14565436782;#######################################################################################################23465784759;Jose Santos;03/07/1968;josesantos@gmail.com;14998786754;0000000000.00;C23465784759;#################################################################################################################################################################95724566812;Roberto Oliveira Jr.;06/07/1976;rojr@house.tech;11976764356;0000000695.00;C95724566812;#############################################################################################################################################################
\echo file ARQUIVO_TRANSACOES
23465784759665456787650000000120.002021101107473754654367865957245668120000000790.002021102919381314565436782665456787650000000050.002021112600231654654367865445654342130000000260.802021121615460623465784759445654342130000000010.002022010616400154654367865445654342130000000200.002022012505581595724566812665456787650000000190.002022021902181295724566812665456787650000000300.002022031014200795724566812665456787650000000200.002022040615160295724566812665456787650000000075.002022042316281644565434213665456787650000001184.402022052014101366545678765957245668120000000100.002022060515305414565436782665456787650000000106.002022062112070695724566812665456787650000000095.002022071107341766545678765145654367820000000670.002022080221274866545678765998765567820000000670.002022082418521966545678765957245668120000000670.002022091223100395724566812665456787650000000005.0020221008014443
\echo index clientes_idx
003145654367820005234657847590006375678765420004#############################################T*********************004546543678650003665456787650000957245668120007998765567820001##############################T*********************001445654342130002###########################################################################F000001***************
\echo index transacoes_idx
0051456543678220211126002316000214565436782202206211207060012234657847592021101107473700002346578475920220106164001000444565434213202205201410130010#############################T*********************006546543678652021121615460600035465436786520220125055815000566545678765202206051530540011665456787652022080221274800146654567876520220824185219001566545678765202209122310030016T*********************0025465436786520211029193813000195724566812202202190218120006####################################################################################################################F000001003************0059572456681220220310142007000795724566812202204061516020008957245668122022042316281600099572456681220220711073417001395724566812202210080144430017#############################T*********************
\echo index chaves_pix_idx
00314565436782####################################1456543678214998786754####################################5465436786515997675654####################################99876556782##############################################################################################################################################################################T*********************00599876556782####################################99876556782galmeida@gmail.com#############################54654367865ge.santana@gmail.com###########################44565434213mariaeugenia@gmail.com#########################66545678765melissa@gmail.com##############################14565436782##########################################################T*********************00215998765645####################################6654567876597301660-afcb-4ea4-a5a6-7c3abe8b8fbb###########66545678765########################################################################################################################################################################################################################################F000003001************00523465784759####################################2346578475944565434213####################################4456543421366545678765####################################665456787658c29d4ca-06a1-4ef4-b45c-0470946831c5###########1456543678295724566812####################################95724566812##########################################################T*********************
\echo index timestamp_cpf_origem_idx
003202110110747372346578475920211029193813546543678652021112600231614565436782###########################################################################T*********************003202201061640012346578475920220125055815546543678652022021902181295724566812###########################################################################T*********************003202112161546065465436786520220310142007957245668122022060515305466545678765###########################################################################F000001003004*********003202204061516029572456681220220423162816957245668122022052014101344565434213###########################################################################T*********************006202206211207061456543678220220711073417957245668122022080221274866545678765202208241852196654567876520220912231003665456787652022100801444395724566812T*********************

SET TIME 1633938457;
OK
SET SRAND 11945338153067011559;
OK

INSERT INTO transacoes VALUES ('melissa@gmail.com', '15997675654', 94);
OK
\echo file ARQUIVO_TRANSACOES
23465784759665456787650000000120.002021101107473754654367865957245668120000000790.002021102919381314565436782665456787650000000050.002021112600231654654367865445654342130000000260.802021121615460623465784759445654342130000000010.002022010616400154654367865445654342130000000200.002022012505581595724566812665456787650000000190.002022021902181295724566812665456787650000000300.002022031014200795724566812665456787650000000200.002022040615160295724566812665456787650000000075.002022042316281644565434213665456787650000001184.402022052014101366545678765957245668120000000100.002022060515305414565436782665456787650000000106.002022062112070695724566812665456787650000000095.002022071107341766545678765145654367820000000670.002022080221274866545678765998765567820000000670.002022082418521966545678765957245668120000000670.002022091223100395724566812665456787650000000005.002022100801444314565436782998765567820000000094.0020211011074737
\echo index transacoes_idx
006145654367822021101107473700181456543678220211126002316000214565436782202206211207060012234657847592021101107473700002346578475920220106164001000444565434213202205201410130010T*********************006546543678652021121615460600035465436786520220125055815000566545678765202206051530540011665456787652022080221274800146654567876520220824185219001566545678765202209122310030016T*********************0025465436786520211029193813000195724566812202202190218120006####################################################################################################################F000001003************0059572456681220220310142007000795724566812202204061516020008957245668122022042316281600099572456681220220711073417001395724566812202210080144430017#############################T*********************
\echo index timestamp_cpf_origem_idx
0042021101107473714565436782202110110747372346578475920211029193813546543678652021112600231614565436782##################################################T*********************003202201061640012346578475920220125055815546543678652022021902181295724566812###########################################################################T*********************003202112161546065465436786520220310142007957245668122022060515305466545678765###########################################################################F000001003004*********003202204061516029572456681220220423162816957245668122022052014101344565434213###########################################################################T*********************006202206211207061456543678220220711073417957245668122022080221274866545678765202208241852196654567876520220912231003665456787652022100801444395724566812T*********************

INSERT INTO transacoes VALUES ('95724566812', '99876556782', 25);
OK
\echo file ARQUIVO_TRANSACOES
23465784759665456787650000000120.002021101107473754654367865957245668120000000790.002021102919381314565436782665456787650000000050.002021112600231654654367865445654342130000000260.802021121615460623465784759445654342130000000010.002022010616400154654367865445654342130000000200.002022012505581595724566812665456787650000000190.002022021902181295724566812665456787650000000300.002022031014200795724566812665456787650000000200.002022040615160295724566812665456787650000000075.002022042316281644565434213665456787650000001184.402022052014101366545678765957245668120000000100.002022060515305414565436782665456787650000000106.002022062112070695724566812665456787650000000095.002022071107341766545678765145654367820000000670.002022080221274866545678765998765567820000000670.002022082418521966545678765957245668120000000670.002022091223100395724566812665456787650000000005.002022100801444314565436782998765567820000000094.002021101107473795724566812998765567820000000025.0020211029193813
\echo index transacoes_idx
006145654367822021101107473700181456543678220211126002316000214565436782202206211207060012234657847592021101107473700002346578475920220106164001000444565434213202205201410130010T*********************003546543678652021121615460600035465436786520220125055815000566545678765202206051530540011#######################################################################################T*********************003546543678652021102919381300016654567876520220802212748001495724566812202202190218120006#######################################################################################F000001004003*********0059572456681220220310142007000795724566812202204061516020008957245668122022042316281600099572456681220220711073417001395724566812202210080144430017#############################T*********************003665456787652022082418521900156654567876520220912231003001695724566812202110291938130019#######################################################################################T*********************
\echo index timestamp_cpf_origem_idx
00520211011074737145654367822021101107473723465784759202110291938135465436786520211029193813957245668122021112600231614565436782#########################T*********************003202201061640012346578475920220125055815546543678652022021902181295724566812###########################################################################T*********************003202112161546065465436786520220310142007957245668122022060515305466545678765###########################################################################F000001003004*********003202204061516029572456681220220423162816957245668122022052014101344565434213###########################################################################T*********************006202206211207061456543678220220711073417957245668122022080221274866545678765202208241852196654567876520220912231003665456787652022100801444395724566812T*********************

INSERT INTO transacoes VALUES ('66545678765', 'ge.santana@gmail.com', 45);
OK
\echo file ARQUIVO_TRANSACOES
23465784759665456787650000000120.002021101107473754654367865957245668120000000790.002021102919381314565436782665456787650000000050.002021112600231654654367865445654342130000000260.802021121615460623465784759445654342130000000010.002022010616400154654367865445654342130000000200.002022012505581595724566812665456787650000000190.002022021902181295724566812665456787650000000300.002022031014200795724566812665456787650000000200.002022040615160295724566812665456787650000000075.002022042316281644565434213665456787650000001184.402022052014101366545678765957245668120000000100.002022060515305414565436782665456787650000000106.002022062112070695724566812665456787650000000095.002022071107341766545678765145654367820000000670.002022080221274866545678765998765567820000000670.002022082418521966545678765957245668120000000670.002022091223100395724566812665456787650000000005.002022100801444314565436782998765567820000000094.002021101107473795724566812998765567820000000025.002021102919381366545678765445654342130000000045.0020211126002316
\echo index transacoes_idx
006145654367822021101107473700181456543678220211126002316000214565436782202206211207060012234657847592021101107473700002346578475920220106164001000444565434213202205201410130010T*********************00454654367865202112161546060003546543678652022012505581500056654567876520211126002316002066545678765202206051530540011##########################################################T*********************003546543678652021102919381300016654567876520220802212748001495724566812202202190218120006#######################################################################################F000001004003*********0059572456681220220310142007000795724566812202204061516020008957245668122022042316281600099572456681220220711073417001395724566812202210080144430017#############################T*********************003665456787652022082418521900156654567876520220912231003001695724566812202110291938130019#######################################################################################T*********************
\echo index timestamp_cpf_origem_idx
006202110110747371456543678220211011074737234657847592021102919381354654367865202110291938139572456681220211126002316145654367822021112600231666545678765T*********************003202201061640012346578475920220125055815546543678652022021902181295724566812###########################################################################T*********************003202112161546065465436786520220310142007957245668122022060515305466545678765###########################################################################F000001003004*********003202204061516029572456681220220423162816957245668122022052014101344565434213###########################################################################T*********************006202206211207061456543678220220711073417957245668122022080221274866545678765202208241852196654567876520220912231003665456787652022100801444395724566812T*********************

INSERT INTO transacoes VALUES ('15998765645', 'ge.santana@gmail.com', 320);
OK
\echo file ARQUIVO_TRANSACOES
23465784759665456787650000000120.002021101107473754654367865957245668120000000790.002021102919381314565436782665456787650000000050.002021112600231654654367865445654342130000000260.802021121615460623465784759445654342130000000010.002022010616400154654367865445654342130000000200.002022012505581595724566812665456787650000000190.002022021902181295724566812665456787650000000300.002022031014200795724566812665456787650000000200.002022040615160295724566812665456787650000000075.002022042316281644565434213665456787650000001184.402022052014101366545678765957245668120000000100.002022060515305414565436782665456787650000000106.002022062112070695724566812665456787650000000095.002022071107341766545678765145654367820000000670.002022080221274866545678765998765567820000000670.002022082418521966545678765957245668120000000670.002022091223100395724566812665456787650000000005.002022100801444314565436782998765567820000000094.002021101107473795724566812998765567820000000025.002021102919381366545678765445654342130000000045.002021112600231666545678765445654342130000000320.0020211216154606
\echo index transacoes_idx
006145654367822021101107473700181456543678220211126002316000214565436782202206211207060012234657847592021101107473700002346578475920220106164001000444565434213202205201410130010T*********************0055465436786520211216154606000354654367865202201250558150005665456787652021112600231600206654567876520211216154606002166545678765202206051530540011#############################T*********************003546543678652021102919381300016654567876520220802212748001495724566812202202190218120006#######################################################################################F000001004003*********0059572456681220220310142007000795724566812202204061516020008957245668122022042316281600099572456681220220711073417001395724566812202210080144430017#############################T*********************003665456787652022082418521900156654567876520220912231003001695724566812202110291938130019#######################################################################################T*********************
\echo index timestamp_cpf_origem_idx
006202110110747371456543678220211011074737234657847592021102919381354654367865202110291938139572456681220211126002316145654367822021112600231666545678765T*********************0042021121615460666545678765202201061640012346578475920220125055815546543678652022021902181295724566812##################################################T*********************003202112161546065465436786520220310142007957245668122022060515305466545678765###########################################################################F000001003004*********003202204061516029572456681220220423162816957245668122022052014101344565434213###########################################################################T*********************006202206211207061456543678220220711073417957245668122022080221274866545678765202208241852196654567876520220912231003665456787652022100801444395724566812T*********************

INSERT INTO transacoes VALUES ('mariaeugenia@gmail.com', 'ge.santana@gmail.com', 75);
OK
\echo file ARQUIVO_TRANSACOES
23465784759665456787650000000120.002021101107473754654367865957245668120000000790.002021102919381314565436782665456787650000000050.002021112600231654654367865445654342130000000260.802021121615460623465784759445654342130000000010.002022010616400154654367865445654342130000000200.002022012505581595724566812665456787650000000190.002022021902181295724566812665456787650000000300.002022031014200795724566812665456787650000000200.002022040615160295724566812665456787650000000075.002022042316281644565434213665456787650000001184.402022052014101366545678765957245668120000000100.002022060515305414565436782665456787650000000106.002022062112070695724566812665456787650000000095.002022071107341766545678765145654367820000000670.002022080221274866545678765998765567820000000670.002022082418521966545678765957245668120000000670.002022091223100395724566812665456787650000000005.002022100801444314565436782998765567820000000094.002021101107473795724566812998765567820000000025.002021102919381366545678765445654342130000000045.002021112600231666545678765445654342130000000320.002021121615460666545678765445654342130000000075.0020220106164001
\echo index transacoes_idx
006145654367822021101107473700181456543678220211126002316000214565436782202206211207060012234657847592021101107473700002346578475920220106164001000444565434213202205201410130010T*********************006546543678652021121615460600035465436786520220125055815000566545678765202111260023160020665456787652021121615460600216654567876520220106164001002266545678765202206051530540011T*********************003546543678652021102919381300016654567876520220802212748001495724566812202202190218120006#######################################################################################F000001004003*********0059572456681220220310142007000795724566812202204061516020008957245668122022042316281600099572456681220220711073417001395724566812202210080144430017#############################T*********************003665456787652022082418521900156654567876520220912231003001695724566812202110291938130019#######################################################################################T*********************
\echo index timestamp_cpf_origem_idx
006202110110747371456543678220211011074737234657847592021102919381354654367865202110291938139572456681220211126002316145654367822021112600231666545678765T*********************00520211216154606665456787652022010616400123465784759202201061640016654567876520220125055815546543678652022021902181295724566812#########################T*********************003202112161546065465436786520220310142007957245668122022060515305466545678765###########################################################################F000001003004*********003202204061516029572456681220220423162816957245668122022052014101344565434213###########################################################################T*********************006202206211207061456543678220220711073417957245668122022080221274866545678765202208241852196654567876520220912231003665456787652022100801444395724566812T*********************

INSERT INTO transacoes VALUES ('99876556782', 'ge.santana@gmail.com', 119);
OK
\echo file ARQUIVO_TRANSACOES
23465784759665456787650000000120.002021101107473754654367865957245668120000000790.002021102919381314565436782665456787650000000050.002021112600231654654367865445654342130000000260.802021121615460623465784759445654342130000000010.002022010616400154654367865445654342130000000200.002022012505581595724566812665456787650000000190.002022021902181295724566812665456787650000000300.002022031014200795724566812665456787650000000200.002022040615160295724566812665456787650000000075.002022042316281644565434213665456787650000001184.402022052014101366545678765957245668120000000100.002022060515305414565436782665456787650000000106.002022062112070695724566812665456787650000000095.002022071107341766545678765145654367820000000670.002022080221274866545678765998765567820000000670.002022082418521966545678765957245668120000000670.002022091223100395724566812665456787650000000005.002022100801444314565436782998765567820000000094.002021101107473795724566812998765567820000000025.002021102919381366545678765445654342130000000045.002021112600231666545678765445654342130000000320.002021121615460666545678765445654342130000000075.002022010616400199876556782445654342130000000119.0020220125055815
\echo index transacoes_idx
006145654367822021101107473700181456543678220211126002316000214565436782202206211207060012234657847592021101107473700002346578475920220106164001000444565434213202205201410130010T*********************006546543678652021121615460600035465436786520220125055815000566545678765202111260023160020665456787652021121615460600216654567876520220106164001002266545678765202206051530540011T*********************003546543678652021102919381300016654567876520220802212748001495724566812202202190218120006#######################################################################################F000001004003*********006957245668122022031014200700079572456681220220406151602000895724566812202204231628160009957245668122022071107341700139572456681220221008014443001799876556782202201250558150023T*********************003665456787652022082418521900156654567876520220912231003001695724566812202110291938130019#######################################################################################T*********************
\echo index timestamp_cpf_origem_idx
006202110110747371456543678220211011074737234657847592021102919381354654367865202110291938139572456681220211126002316145654367822021112600231666545678765T*********************006202112161546066654567876520220106164001234657847592022010616400166545678765202201250558155465436786520220125055815998765567822022021902181295724566812T*********************003202112161546065465436786520220310142007957245668122022060515305466545678765###########################################################################F000001003004*********003202204061516029572456681220220423162816957245668122022052014101344565434213###########################################################################T*********************006202206211207061456543678220220711073417957245668122022080221274866545678765202208241852196654567876520220912231003665456787652022100801444395724566812T*********************

INSERT INTO transacoes VALUES ('44565434213', '15998765645', 334.6);
OK
\echo file ARQUIVO_TRANSACOES
23465784759665456787650000000120.002021101107473754654367865957245668120000000790.002021102919381314565436782665456787650000000050.002021112600231654654367865445654342130000000260.802021121615460623465784759445654342130000000010.002022010616400154654367865445654342130000000200.002022012505581595724566812665456787650000000190.002022021902181295724566812665456787650000000300.002022031014200795724566812665456787650000000200.002022040615160295724566812665456787650000000075.002022042316281644565434213665456787650000001184.402022052014101366545678765957245668120000000100.002022060515305414565436782665456787650000000106.002022062112070695724566812665456787650000000095.002022071107341766545678765145654367820000000670.002022080221274866545678765998765567820000000670.002022082418521966545678765957245668120000000670.002022091223100395724566812665456787650000000005.002022100801444314565436782998765567820000000094.002021101107473795724566812998765567820000000025.002021102919381366545678765445654342130000000045.002021112600231666545678765445654342130000000320.002021121615460666545678765445654342130000000075.002022010616400199876556782445654342130000000119.002022012505581544565434213665456787650000000334.6020220219021812
\echo index transacoes_idx
003145654367822021101107473700181456543678220211126002316000214565436782202206211207060012#######################################################################################T*********************006546543678652021121615460600035465436786520220125055815000566545678765202111260023160020665456787652021121615460600216654567876520220106164001002266545678765202206051530540011T*********************00423465784759202110110747370000546543678652021102919381300016654567876520220802212748001495724566812202202190218120006##########################################################F000005001004003******006957245668122022031014200700079572456681220220406151602000895724566812202204231628160009957245668122022071107341700139572456681220221008014443001799876556782202201250558150023T*********************003665456787652022082418521900156654567876520220912231003001695724566812202110291938130019#######################################################################################T*********************003234657847592022010616400100044456543421320220219021812002444565434213202205201410130010#######################################################################################T*********************
\echo index timestamp_cpf_origem_idx
006202110110747371456543678220211011074737234657847592021102919381354654367865202110291938139572456681220211126002316145654367822021112600231666545678765T*********************003202112161546066654567876520220106164001234657847592022010616400166545678765###########################################################################T*********************0042021121615460654654367865202201250558155465436786520220310142007957245668122022060515305466545678765##################################################F000001005003004******003202204061516029572456681220220423162816957245668122022052014101344565434213###########################################################################T*********************006202206211207061456543678220220711073417957245668122022080221274866545678765202208241852196654567876520220912231003665456787652022100801444395724566812T*********************003202201250558159987655678220220219021812445654342132022021902181295724566812###########################################################################T*********************

INSERT INTO transacoes VALUES ('ge.santana@gmail.com', '23465784759', 1340);
OK
\echo file ARQUIVO_TRANSACOES
23465784759665456787650000000120.002021101107473754654367865957245668120000000790.002021102919381314565436782665456787650000000050.002021112600231654654367865445654342130000000260.802021121615460623465784759445654342130000000010.002022010616400154654367865445654342130000000200.002022012505581595724566812665456787650000000190.002022021902181295724566812665456787650000000300.002022031014200795724566812665456787650000000200.002022040615160295724566812665456787650000000075.002022042316281644565434213665456787650000001184.402022052014101366545678765957245668120000000100.002022060515305414565436782665456787650000000106.002022062112070695724566812665456787650000000095.002022071107341766545678765145654367820000000670.002022080221274866545678765998765567820000000670.002022082418521966545678765957245668120000000670.002022091223100395724566812665456787650000000005.002022100801444314565436782998765567820000000094.002021101107473795724566812998765567820000000025.002021102919381366545678765445654342130000000045.002021112600231666545678765445654342130000000320.002021121615460666545678765445654342130000000075.002022010616400199876556782445654342130000000119.002022012505581544565434213665456787650000000334.602022021902181244565434213234657847590000001340.0020220310142007
\echo index transacoes_idx
003145654367822021101107473700181456543678220211126002316000214565436782202206211207060012#######################################################################################T*********************006546543678652021121615460600035465436786520220125055815000566545678765202111260023160020665456787652021121615460600216654567876520220106164001002266545678765202206051530540011T*********************00423465784759202110110747370000546543678652021102919381300016654567876520220802212748001495724566812202202190218120006##########################################################F000005001004003******006957245668122022031014200700079572456681220220406151602000895724566812202204231628160009957245668122022071107341700139572456681220221008014443001799876556782202201250558150023T*********************003665456787652022082418521900156654567876520220912231003001695724566812202110291938130019#######################################################################################T*********************00423465784759202201061640010004445654342132022021902181200244456543421320220310142007002544565434213202205201410130010##########################################################T*********************
\echo index timestamp_cpf_origem_idx
006202110110747371456543678220211011074737234657847592021102919381354654367865202110291938139572456681220211126002316145654367822021112600231666545678765T*********************003202112161546066654567876520220106164001234657847592022010616400166545678765###########################################################################T*********************0042021121615460654654367865202201250558155465436786520220310142007957245668122022060515305466545678765##################################################F000001005003004******003202204061516029572456681220220423162816957245668122022052014101344565434213###########################################################################T*********************006202206211207061456543678220220711073417957245668122022080221274866545678765202208241852196654567876520220912231003665456787652022100801444395724566812T*********************0042022012505581599876556782202202190218124456543421320220219021812957245668122022031014200744565434213##################################################T*********************

INSERT INTO transacoes VALUES ('23465784759', 'galmeida@gmail.com', 670);
OK
\echo file ARQUIVO_CLIENTES
66545678765;Maria Eugenia;12/04/1980;mariaeugenia@gmail.com;15998765645;0000000670.00;A97301660-afcb-4ea4-a5a6-7c3abe8b8fbb&C66545678765&N15998765645&Emariaeugenia@gmail.com;##################################################################################99876556782;Gabriel Augusto;04/05/1997;ga.augusto@gmail.com;15997675654;0000000670.00;C99876556782&N15997675654;################################################################################################################################################44565434213;Geovana Santana;25/10/1994;ge.santana@gmail.com;16996543652;0000000670.80;Ege.santana@gmail.com&C44565434213;#######################################################################################################################################54654367865;Gustavo Almeida;19/11/1992;galmeida@gmail.com;14998786754;0000000670.00;N14998786754&Egalmeida@gmail.com;###########################################################################################################################################37567876542;Melissa Santos;13/04/1977;melissa@gmail.com;15998765435;1000000440.92;;#############################################################################################################################################################################14565436782;Melissa Pereira;19/09/1993;melissa@gmail.com;15997654738;0000000670.00;Emelissa@gmail.com&A8c29d4ca-06a1-4ef4-b45c-0470946831c5&C14565436782;#######################################################################################################23465784759;Jose Santos;03/07/1968;josesantos@gmail.com;14998786754;0000000670.00;C23465784759;#################################################################################################################################################################95724566812;Roberto Oliveira Jr.;06/07/1976;rojr@house.tech;11976764356;0000000670.00;C95724566812;#############################################################################################################################################################
\echo file ARQUIVO_TRANSACOES
23465784759665456787650000000120.002021101107473754654367865957245668120000000790.002021102919381314565436782665456787650000000050.002021112600231654654367865445654342130000000260.802021121615460623465784759445654342130000000010.002022010616400154654367865445654342130000000200.002022012505581595724566812665456787650000000190.002022021902181295724566812665456787650000000300.002022031014200795724566812665456787650000000200.002022040615160295724566812665456787650000000075.002022042316281644565434213665456787650000001184.402022052014101366545678765957245668120000000100.002022060515305414565436782665456787650000000106.002022062112070695724566812665456787650000000095.002022071107341766545678765145654367820000000670.002022080221274866545678765998765567820000000670.002022082418521966545678765957245668120000000670.002022091223100395724566812665456787650000000005.002022100801444314565436782998765567820000000094.002021101107473795724566812998765567820000000025.002021102919381366545678765445654342130000000045.002021112600231666545678765445654342130000000320.002021121615460666545678765445654342130000000075.002022010616400199876556782445654342130000000119.002022012505581544565434213665456787650000000334.602022021902181244565434213234657847590000001340.002022031014200723465784759546543678650000000670.0020220406151602
\echo index clientes_idx
003145654367820005234657847590006375678765420004#############################################T*********************004546543678650003665456787650000957245668120007998765567820001##############################T*********************001445654342130002###########################################################################F000001***************
\echo index transacoes_idx
003145654367822021101107473700181456543678220211126002316000214565436782202206211207060012#######################################################################################T*********************006546543678652021121615460600035465436786520220125055815000566545678765202111260023160020665456787652021121615460600216654567876520220106164001002266545678765202206051530540011T*********************00423465784759202110110747370000546543678652021102919381300016654567876520220802212748001495724566812202202190218120006##########################################################F000005001004003******006957245668122022031014200700079572456681220220406151602000895724566812202204231628160009957245668122022071107341700139572456681220221008014443001799876556782202201250558150023T*********************003665456787652022082418521900156654567876520220912231003001695724566812202110291938130019#######################################################################################T*********************0052346578475920220106164001000423465784759202204061516020026445654342132022021902181200244456543421320220310142007002544565434213202205201410130010#############################T*********************
\echo index chaves_pix_idx
00314565436782####################################1456543678214998786754####################################5465436786515997675654####################################99876556782##############################################################################################################################################################################T*********************00599876556782####################################99876556782galmeida@gmail.com#############################54654367865ge.santana@gmail.com###########################44565434213mariaeugenia@gmail.com#########################66545678765melissa@gmail.com##############################14565436782##########################################################T*********************00215998765645####################################6654567876597301660-afcb-4ea4-a5a6-7c3abe8b8fbb###########66545678765########################################################################################################################################################################################################################################F000003001************00523465784759####################################2346578475944565434213####################################4456543421366545678765####################################665456787658c29d4ca-06a1-4ef4-b45c-0470946831c5###########1456543678295724566812####################################95724566812##########################################################T*********************
\echo index timestamp_cpf_origem_idx
006202110110747371456543678220211011074737234657847592021102919381354654367865202110291938139572456681220211126002316145654367822021112600231666545678765T*********************003202112161546066654567876520220106164001234657847592022010616400166545678765###########################################################################T*********************0042021121615460654654367865202201250558155465436786520220310142007957245668122022060515305466545678765##################################################F000001005003004******0042022040615160223465784759202204061516029572456681220220423162816957245668122022052014101344565434213##################################################T*********************006202206211207061456543678220220711073417957245668122022080221274866545678765202208241852196654567876520220912231003665456787652022100801444395724566812T*********************0042022012505581599876556782202202190218124456543421320220219021812957245668122022031014200744565434213##################################################T*********************

-- busca de transação
SELECT * FROM transacoes WHERE cpf_origem = '14565436782' AND timestamp = '20211126002316';
Nos percorridos: 2 0
14565436782, 66545678765, 50.00, 20211126002316
SELECT * FROM transacoes WHERE cpf_origem = '14565436782' AND timestamp = '20211011074737';
Nos percorridos: 2 0
14565436782, 99876556782, 94.00, 20211011074737
SELECT * FROM transacoes WHERE cpf_origem = '23465784759' AND timestamp = '20211011074737';
Nos percorridos: 2
23465784759, 66545678765, 120.00, 20211011074737
SELECT * FROM transacoes WHERE cpf_origem = '95724566812' AND timestamp = '20221008014443';
Nos percorridos: 2 3
95724566812, 66545678765, 5.00, 20221008014443
SELECT * FROM transacoes WHERE cpf_origem = '95724566812' AND timestamp = '20221008014444';
Nos percorridos: 2 3
ERRO: Registro nao encontrado
SELECT * FROM transacoes WHERE cpf_origem = '14565436782' AND timestamp = '20211029193813';
Nos percorridos: 2 0
ERRO: Registro nao encontrado

-- listagem de transação por período
SELECT * FROM transacoes WHERE timestamp BETWEEN '20211011074737' AND '20221008014443' ORDER BY timestamp ASC;
14565436782, 99876556782, 94.00, 20211011074737
23465784759, 66545678765, 120.00, 20211011074737
54654367865, 95724566812, 790.00, 20211029193813
95724566812, 99876556782, 25.00, 20211029193813
14565436782, 66545678765, 50.00, 20211126002316
66545678765, 44565434213, 45.00, 20211126002316
54654367865, 44565434213, 260.80, 20211216154606
66545678765, 44565434213, 320.00, 20211216154606
23465784759, 44565434213, 10.00, 20220106164001
66545678765, 44565434213, 75.00, 20220106164001
54654367865, 44565434213, 200.00, 20220125055815
99876556782, 44565434213, 119.00, 20220125055815
44565434213, 66545678765, 334.60, 20220219021812
95724566812, 66545678765, 190.00, 20220219021812
44565434213, 23465784759, 1340.00, 20220310142007
95724566812, 66545678765, 300.00, 20220310142007
23465784759, 54654367865, 670.00, 20220406151602
95724566812, 66545678765, 200.00, 20220406151602
95724566812, 66545678765, 75.00, 20220423162816
44565434213, 66545678765, 1184.40, 20220520141013
66545678765, 95724566812, 100.00, 20220605153054
14565436782, 66545678765, 106.00, 20220621120706
95724566812, 66545678765, 95.00, 20220711073417
66545678765, 14565436782, 670.00, 20220802212748
66545678765, 99876556782, 670.00, 20220824185219
66545678765, 95724566812, 670.00, 20220912231003
95724566812, 66545678765, 5.00, 20221008014443
SELECT * FROM transacoes WHERE timestamp BETWEEN '20211011074737' AND '20211011074737' ORDER BY timestamp ASC;
14565436782, 99876556782, 94.00, 20211011074737
23465784759, 66545678765, 120.00, 20211011074737
SELECT * FROM transacoes WHERE timestamp BETWEEN '20211029193813' AND '20211029193813' ORDER BY timestamp ASC;
54654367865, 95724566812, 790.00, 20211029193813
95724566812, 99876556782, 25.00, 20211029193813
SELECT * FROM transacoes WHERE timestamp BETWEEN '20211126002316' AND '20211126002316' ORDER BY timestamp ASC;
14565436782, 66545678765, 50.00, 20211126002316
66545678765, 44565434213, 45.00, 20211126002316
SELECT * FROM transacoes WHERE timestamp BETWEEN '20211216154606' AND '20211216154606' ORDER BY timestamp ASC;
54654367865, 44565434213, 260.80, 20211216154606
66545678765, 44565434213, 320.00, 20211216154606
SELECT * FROM transacoes WHERE timestamp BETWEEN '20220106164001' AND '20220106164001' ORDER BY timestamp ASC;
23465784759, 44565434213, 10.00, 20220106164001
66545678765, 44565434213, 75.00, 20220106164001
SELECT * FROM transacoes WHERE timestamp BETWEEN '20220125055815' AND '20220125055815' ORDER BY timestamp ASC;
54654367865, 44565434213, 200.00, 20220125055815
99876556782, 44565434213, 119.00, 20220125055815
SELECT * FROM transacoes WHERE timestamp BETWEEN '20220219021812' AND '20220219021812' ORDER BY timestamp ASC;
44565434213, 66545678765, 334.60, 20220219021812
95724566812, 66545678765, 190.00, 20220219021812
SELECT * FROM transacoes WHERE timestamp BETWEEN '20220310142007' AND '20220310142007' ORDER BY timestamp ASC;
44565434213, 23465784759, 1340.00, 20220310142007
95724566812, 66545678765, 300.00, 20220310142007
SELECT * FROM transacoes WHERE timestamp BETWEEN '20220406151602' AND '20220406151602' ORDER BY timestamp ASC;
23465784759, 54654367865, 670.00, 20220406151602
95724566812, 66545678765, 200.00, 20220406151602
SELECT * FROM transacoes WHERE timestamp BETWEEN '20220125055815' AND '20220219021812' ORDER BY timestamp ASC;
54654367865, 44565434213, 200.00, 20220125055815
99876556782, 44565434213, 119.00, 20220125055815
44565434213, 66545678765, 334.60, 20220219021812
95724566812, 66545678765, 190.00, 20220219021812
SELECT * FROM transacoes WHERE timestamp BETWEEN '20221008014443' AND '20221008014443' ORDER BY timestamp ASC;
95724566812, 66545678765, 5.00, 20221008014443
SELECT * FROM transacoes WHERE timestamp BETWEEN '20220219021812' AND '20220125055815' ORDER BY timestamp ASC;
AVISO: Nenhum registro encontrado
SELECT * FROM transacoes WHERE timestamp BETWEEN '20221008014443' AND '2023' ORDER BY timestamp ASC;
95724566812, 66545678765, 5.00, 20221008014443
SELECT * FROM transacoes WHERE timestamp BETWEEN '2021' AND '20211011074737' ORDER BY timestamp ASC;
14565436782, 99876556782, 94.00, 20211011074737
23465784759, 66545678765, 120.00, 20211011074737

-- listagem de transação por CPF de origem e período
SELECT * FROM transacoes WHERE cpf_origem = '99876556782' AND timestamp BETWEEN '20211011074737' AND '20221008014443' ORDER BY timestamp ASC;
99876556782, 44565434213, 119.00, 20220125055815
SELECT * FROM transacoes WHERE cpf_origem = '66545678765' AND timestamp BETWEEN '20211011074737' AND '20221008014443' ORDER BY timestamp ASC;
66545678765, 44565434213, 45.00, 20211126002316
66545678765, 44565434213, 320.00, 20211216154606
66545678765, 44565434213, 75.00, 20220106164001
66545678765, 95724566812, 100.00, 20220605153054
66545678765, 14565436782, 670.00, 20220802212748
66545678765, 99876556782, 670.00, 20220824185219
66545678765, 95724566812, 670.00, 20220912231003
SELECT * FROM transacoes WHERE cpf_origem = '95724566812' AND timestamp BETWEEN '20211011074737' AND '20211029193813' ORDER BY timestamp ASC;
95724566812, 99876556782, 25.00, 20211029193813
SELECT * FROM transacoes WHERE cpf_origem = '95724566812' AND timestamp BETWEEN '20211126002316' AND '20220219021811' ORDER BY timestamp ASC;
AVISO: Nenhum registro encontrado
SELECT * FROM transacoes WHERE cpf_origem = '99876556782' AND timestamp BETWEEN '20221008014443' AND '20211011074737' ORDER BY timestamp ASC;
AVISO: Nenhum registro encontrado
SELECT * FROM transacoes WHERE cpf_origem = '95724566812' AND timestamp BETWEEN '20220310142007' AND '20220406151602' ORDER BY timestamp ASC;
95724566812, 66545678765, 300.00, 20220310142007
95724566812, 66545678765, 200.00, 20220406151602
SELECT * FROM transacoes WHERE cpf_origem = '23465784759' AND timestamp BETWEEN '20220310142007' AND '20220406151602' ORDER BY timestamp ASC;
23465784759, 54654367865, 670.00, 20220406151602
SELECT * FROM transacoes WHERE cpf_origem = '23465784759' AND timestamp BETWEEN '20220310142007' AND '20220406151602' ORDER BY timestamp ASC;
23465784759, 54654367865, 670.00, 20220406151602
SELECT * FROM transacoes WHERE cpf_origem = '14565436782' AND timestamp BETWEEN '202201' AND '202203' ORDER BY timestamp ASC;
AVISO: Nenhum registro encontrado

\q
